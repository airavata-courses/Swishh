version: 2.1
  
jobs:
  build:
    docker:
      - image: circleci/openjdk:8-jdk
    working_directory: ~/repo
    steps:
      - setup_remote_docker:
          version: 18.09.3
      - checkout
      - run: pwd
      - run: docker login --username $DOCKER_USER --password $DCOKER_PASS
      - run: cd ImageStorage && ls -la && mvn clean install package && docker image build . -t harihareeshb/image-storage:latest && docker push harihareeshb/image-storage:latest

      # store raw contents of src code
      - store_artifacts:
          path: /target/classes
          destination: swishh-imagestorage-api
